# [015]详细功能点清单

**文档编号**: 015  
**文档类型**: 阶段性文档 - 详细功能清单  
**创建时间**: 2025-10-31  
**最后更新**: 2025-10-31  
**项目名称**: GUET-InduEdu AI智能面试官系统

---

## 目录

1. [后端微服务功能清单](#后端微服务功能清单)
2. [数据库功能清单](#数据库功能清单)
3. [API接口功能清单](#api接口功能清单)
4. [前端功能清单](#前端功能清单)
5. [集成与工作流功能](#集成与工作流功能)
6. [安全与认证功能](#安全与认证功能)
7. [运维与监控功能](#运维与监控功能)
8. [未实现功能清单](#未实现功能清单)

---

## 后端微服务功能清单

### 1. PDF解析服务 (pdf-parser-service) - 端口8003

#### 核心功能 ✅
1. **PDF文件上传处理**
   - ✅ 支持multipart/form-data文件上传
   - ✅ 文件类型验证（仅支持.pdf）
   - ✅ 文件大小限制（最大10MB）
   - ✅ 临时文件管理（上传后自动清理）

2. **PDF文本提取**
   - ✅ PyMuPDF引擎解析
   - ✅ pdfplumber备用解析
   - ✅ 双引擎自动切换
   - ✅ OCR支持（图片文字识别）
   - ✅ 多页面文档处理
   - ✅ 表格内容提取
   - ✅ 格式化输出

3. **文档分块处理**
   - ✅ 智能分块（chunk_size: 1000字符）
   - ✅ 重叠处理（overlap: 200字符）
   - ✅ 段落保持完整性
   - ✅ 内容去重

4. **错误处理**
   - ✅ 文件格式错误提示
   - ✅ 解析失败自动重试
   - ✅ 详细错误日志记录
   - ✅ 友好的错误信息返回

5. **性能优化**
   - ✅ 异步IO处理
   - ✅ 内存优化（大文件流式处理）
   - ✅ 解析超时控制
   - ✅ 并发请求限制（60次/分钟）

#### API接口功能
1. `POST /parse-pdf` ✅
   - 接收PDF文件
   - 返回提取的文本内容
   - 支持双引擎解析
   - 返回内容统计信息

2. `GET /health` ✅
   - 服务健康状态检查
   - 服务版本信息
   - 运行时长统计
   - 配置信息展示

3. `GET /` ✅
   - 服务基本信息
   - API文档链接
   - 使用说明

---

### 2. 简历分析服务 (analysis-service) - 端口8004

#### 核心功能 ✅

##### 2.1 简历智能分析
1. **PDF简历处理**
   - ✅ 调用PDF解析服务
   - ✅ 文本内容验证（最少50字符）
   - ✅ 本地解析fallback机制
   - ✅ 解析失败友好提示

2. **LLM智能提取**
   - ✅ 智谱AI GLM-4集成
   - ✅ 结构化信息提取
   - ✅ 基础字段提取（13个）
     - ✅ 姓名、电话、邮箱
     - ✅ 居住地址
     - ✅ 教育背景描述
     - ✅ 技术方向
     - ✅ 总工作年限
     - ✅ 技能水平等级
     - ✅ 工作经验列表
     - ✅ 项目经验列表
     - ✅ 技术技能列表
   - ✅ 扩展字段提取（8个）
     - ✅ 性别 (gender)
     - ✅ 年龄 (age)
     - ✅ 民族 (ethnicity)
     - ✅ 政治面貌 (political_status)
     - ✅ 院校 (university)
     - ✅ 专业 (major)
     - ✅ 工作经验详细JSON (work_experience_detail_json)
     - ✅ 项目经验详细JSON (project_experience_detail_json)

3. **关键词提取**
   - ✅ 技术技能关键词提取
   - ✅ 项目关键词提取
   - ✅ 技术方向识别
   - ✅ 关键词去重和清洗
   - ✅ 关键词分类存储

4. **候选人档案管理**
   - ✅ 创建新档案
   - ✅ 更新现有档案（overwrite模式）
   - ✅ 查询用户档案
   - ✅ 检查档案是否存在
   - ✅ 档案数据验证

##### 2.2 数据库操作
1. **档案CRUD操作**
   - ✅ 创建候选人档案
   - ✅ 读取档案信息
   - ✅ 更新档案内容
   - ✅ 档案存在性检查
   - ✅ 批量查询支持

2. **关联表管理**
   - ✅ 工作经验表操作
   - ✅ 项目经验表操作
   - ✅ 技术技能表操作
   - ✅ 级联删除和更新

3. **数据统计**
   - ✅ 档案总数统计
   - ✅ 用户活跃度统计
   - ✅ 数据完整性检查

##### 2.3 Dify工作流支持
1. **关键词分组接口**
   - ✅ 技术技能列表
   - ✅ 项目关键词列表
   - ✅ 技术方向信息
   - ✅ 检索友好格式
   - ✅ Dify使用指南

2. **档案查询接口**
   - ✅ 完整档案信息
   - ✅ 简化字段返回
   - ✅ 格式化输出

#### API接口功能
1. `POST /analyze` ✅
   - 上传PDF简历
   - 智能分析和信息提取
   - 支持comprehensive/basic两种模式
   - 返回完整候选人档案
   - 返回处理时间统计

2. `POST /keywords` ✅
   - 查询用户关键词
   - 支持category筛选（technical/projects/all）
   - 支持string/list两种格式
   - 返回技术技能、项目、方向

3. `GET /keywords/grouped/{user_id}` ✅
   - Dify专用关键词接口
   - 技术技能列表和文本
   - 项目关键词详细信息
   - 检索文本格式化
   - 使用指南

4. `POST /parse-pdf` ✅
   - 仅解析PDF不保存
   - 返回文本内容
   - 返回内容长度

5. `POST /profile` ✅
   - 查询用户完整档案
   - 包含所有字段
   - 格式化返回

6. `GET /analyze/status/{user_id}` ✅
   - 查询分析状态
   - 档案是否存在
   - 数据完整性

7. `GET /health` ✅
   - 服务健康状态
   - 数据库连接状态
   - LLM服务可用性
   - PDF解析服务状态
   - 档案总数统计

8. `GET /` ✅
   - 服务基本信息
   - API列表

---

### 3. 向量存储服务 (vector-storage-service) - 端口8005

#### 核心功能 ✅

##### 3.1 向量化处理
1. **文本向量化**
   - ✅ 智谱AI Embedding-2模型
   - ✅ 自动维度适配
   - ✅ 批量向量化支持
   - ✅ 向量归一化
   - ✅ 缓存机制

2. **向量质量控制**
   - ✅ 向量维度验证
   - ✅ 空向量检测
   - ✅ 异常向量过滤
   - ✅ 向量相似度检查

##### 3.2 Milvus向量存储
1. **集合管理**
   - ✅ 自动创建集合
   - ✅ Schema定义和验证
   - ✅ 索引创建和优化
   - ✅ 集合删除和清理

2. **向量CRUD操作**
   - ✅ 向量插入（单个/批量）
   - ✅ 向量查询
   - ✅ 向量更新
   - ✅ 向量删除
   - ✅ 批量操作支持

3. **向量检索**
   - ✅ 相似度搜索（余弦/欧氏/内积）
   - ✅ TopK检索
   - ✅ 距离阈值过滤
   - ✅ 元数据过滤
   - ✅ 分页支持

##### 3.3 语义搜索
1. **智能检索**
   - ✅ 自然语言查询
   - ✅ 多条件组合检索
   - ✅ 相关度排序
   - ✅ 结果聚类

2. **检索优化**
   - ✅ 查询重写
   - ✅ 同义词扩展
   - ✅ 结果去重
   - ✅ 缓存热门查询

##### 3.4 数据持久化
1. **数据备份**
   - ✅ 定期快照
   - ✅ 增量备份
   - ✅ 数据恢复

2. **数据同步**
   - ✅ 与MySQL同步
   - ✅ 数据一致性检查
   - ✅ 冲突解决

#### API接口功能
1. `POST /vectorize` ✅
   - 文本向量化
   - 批量处理
   - 返回向量数据

2. `POST /store` ✅
   - 向量存储
   - 元数据关联
   - 自动索引

3. `POST /search` ✅
   - 语义搜索
   - 相似度检索
   - 结果排序

4. `GET /health` ✅
   - Milvus连接状态
   - 集合统计
   - 服务状态

---

### 4. 面试记录服务 (interview-service) - 端口8006

#### 核心功能 ✅

##### 4.1 面试会话管理
1. **会话创建**
   - ✅ 生成唯一session_id
   - ✅ 设置面试类型（technical/behavioral/综合）
   - ✅ 设置难度级别（easy/medium/hard）
   - ✅ 设置预计时长（estimated_duration）
   - ✅ 设置题目总数（total_questions）
   - ✅ 自动生成会话名称
   - ✅ 初始化会话状态（pending）

2. **会话状态管理**
   - ✅ 状态流转控制（pending → in_progress → completed → canceled）
   - ✅ 开始面试（记录start_time）
   - ✅ 结束面试（记录end_time, actual_duration）
   - ✅ 取消面试
   - ✅ 状态验证

3. **会话查询**
   - ✅ 按用户ID查询所有会话
   - ✅ 按状态筛选会话
   - ✅ 分页支持（limit参数）
   - ✅ 查询最新会话
   - ✅ 会话详情查询（简化版）
     - 包含基本信息
     - 包含题目统计（实际题目数量）
     - 包含评分统计（平均分）
     - 不包含完整题目列表

4. **会话统计**
   - ✅ 完成题目数统计（completed_questions）
   - ✅ 实际用时计算（actual_duration）
   - ✅ 平均分计算
   - ✅ 会话摘要生成

##### 4.2 面试题目管理
1. **题目创建**
   - ✅ 生成唯一question_id
   - ✅ 题目文本存储
   - ✅ 题目类型分类（technical/behavioral/case/coding）
   - ✅ 题目分类（question_category）
   - ✅ 难度标记
   - ✅ 题目顺序管理（question_order）
   - ✅ 知识点标记（knowledge_points）

2. **题目查询**
   - ✅ 按会话查询所有题目
   - ✅ 按类型筛选题目
   - ✅ 按难度筛选题目
   - ✅ 题目详情查询

3. **题目统计**
   - ✅ 题目总数统计
   - ✅ 按类型统计
   - ✅ 按难度统计

##### 4.3 回答记录管理
1. **回答记录**
   - ✅ 候选人回答存储
   - ✅ 面试官反馈存储
   - ✅ 综合评分（overall_score）
   - ✅ 回答时间记录
   - ✅ 自动错题标记（is_wrong_question）

2. **回答查询**
   - ✅ 查询题目回答
   - ✅ 查询所有回答
   - ✅ 查询评分信息

3. **回答评分**
   - ✅ 单项评分
   - ✅ 综合评分
   - ✅ 评分统计

##### 4.4 错题集功能
1. **错题自动标记**
   - ✅ 基于评分阈值自动标记（< 60分）
   - ✅ 实时标记机制
   - ✅ 标记状态更新

2. **错题查询**
   - ✅ 查询用户所有错题
   - ✅ 按题目类型筛选
   - ✅ 按难度筛选
   - ✅ 分页支持
   - ✅ 返回完整题目信息
   - ✅ 返回回答和反馈
   - ✅ 返回评分信息

3. **错题关键词提取**
   - ✅ 提取错题知识点
   - ✅ 生成关键词组合
   - ✅ 支持Dify循环题目生成
   - ✅ 按题目类型筛选关键词
   - ✅ 返回指定数量的关键词组

4. **错题统计**
   - ✅ 错题总数统计
   - ✅ 按类型统计错题
   - ✅ 按知识点统计错题
   - ✅ 错题率计算

##### 4.5 Dify工作流集成
1. **Dify专用接口**
   - ✅ 创建面试（dify_create_interview）
     - 支持题目总数指定
     - 支持预计时长设置
     - 返回完整会话信息
   - ✅ 添加问答（dify_add_qa）
     - 一次性添加题目和回答
     - 自动错题标记
     - 知识点记录
   - ✅ 获取最新面试（dify_get_latest_interview）
   - ✅ 获取面试摘要（dify_get_interview_summary）
   - ✅ 获取错题集（dify_get_wrong_questions）
   - ✅ 获取错题关键词（dify_get_wrong_question_keywords）

2. **数据格式优化**
   - ✅ Dify友好的JSON格式
   - ✅ 简化的返回结构
   - ✅ 清晰的字段命名

##### 4.6 与其他服务集成
1. **简历分析服务集成**
   - ✅ 调用候选人档案接口
   - ✅ 获取用户简历信息
   - ✅ 超时和错误处理

2. **服务间通信**
   - ✅ HTTP客户端封装
   - ✅ 异步调用支持
   - ✅ 重试机制

#### API接口功能（14个）

##### Dify专用接口（6个）
1. `POST /dify/interview/create` ✅
   - 创建面试会话
   - 参数：user_id, session_name, session_type, difficulty_level, estimated_duration, total_questions
   - 返回：完整会话信息（包含session_type, difficulty_level, estimated_duration, total_questions）

2. `POST /dify/interview/add-qa` ✅
   - 添加问答记录
   - 参数：session_id, question_text, question_type, question_category, candidate_answer, interviewer_feedback, overall_score, knowledge_points
   - 自动错题标记

3. `GET /dify/interview/{user_id}/latest` ✅
   - 获取最新面试
   - 返回最新一次面试会话

4. `GET /dify/interview/{session_id}/summary` ✅
   - 获取面试摘要
   - 返回会话统计信息

5. `GET /dify/interview/{user_id}/wrong-questions` ✅
   - 获取错题集
   - 支持question_type筛选
   - 支持limit分页

6. `GET /dify/interview/{user_id}/wrong-question-keywords` ✅
   - 获取错题关键词
   - 返回m组关键词用于循环生成题目
   - 支持required_count指定数量
   - 支持question_type筛选

##### 标准RESTful接口（8个）
1. `POST /interview/sessions` ✅
   - 创建面试会话
   - 标准REST接口

2. `GET /interview/sessions/{user_id}` ✅
   - 获取用户所有面试会话
   - 支持status筛选
   - 支持limit分页

3. `GET /interview/sessions/{session_id}/detail` ✅
   - 获取会话详情（简化版）
   - 返回基本信息
   - 返回题目统计（question_count）
   - 返回平均分（average_score）
   - 不返回完整题目列表

4. `POST /interview/sessions/{session_id}/start` ✅
   - 开始面试
   - 状态变更为in_progress
   - 记录开始时间

5. `POST /interview/sessions/{session_id}/finish` ✅
   - 结束面试
   - 状态变更为completed
   - 记录结束时间
   - 计算实际用时

6. `GET /interview/wrong-questions/{user_id}` ✅
   - 获取错题集（标准版）
   - 支持question_type筛选
   - 支持difficulty_level筛选
   - 支持limit分页

7. `GET /health` ✅
   - 健康检查
   - 数据库连接状态
   - analysis-service连接状态

8. `GET /` ✅
   - 服务信息
   - API列表

---

### 5. 用户认证服务 (user-auth-service) - 端口8007

#### 核心功能 ✅

##### 5.1 用户注册
1. **注册流程**
   - ✅ 用户名唯一性验证
   - ✅ 邮箱唯一性验证
   - ✅ 密码强度验证（可选）
   - ✅ 生成用户UUID (user_id)
   - ✅ 密码bcrypt加密存储
   - ✅ 用户信息保存

2. **数据验证**
   - ✅ 用户名格式验证（3-50字符）
   - ✅ 邮箱格式验证
   - ✅ 密码长度验证（6-100字符）
   - ✅ 必填字段检查

3. **注册安全**
   - ✅ 防重复注册
   - ✅ 防SQL注入
   - ✅ 密码不明文存储
   - ✅ 错误信息脱敏

##### 5.2 用户登录
1. **登录验证**
   - ✅ 用户名/邮箱登录支持
   - ✅ 密码bcrypt验证
   - ✅ 用户状态检查（is_active）
   - ✅ 登录失败计数（可选）

2. **Token生成**
   - ✅ JWT Access Token生成（30分钟有效期）
   - ✅ JWT Refresh Token生成（7天有效期）
   - ✅ Token payload自定义
   - ✅ Token签名和加密

3. **登录记录**
   - ✅ 更新最后登录时间（last_login_at）
   - ✅ 登录日志记录
   - ✅ 登录IP记录（可选）

##### 5.3 Token管理
1. **Token验证**
   - ✅ Access Token解码
   - ✅ Token过期检查
   - ✅ Token签名验证
   - ✅ 用户ID提取

2. **Token刷新**
   - ✅ Refresh Token验证
   - ✅ 生成新Access Token
   - ✅ 延长会话时间
   - ✅ 旧Token失效

3. **Token撤销**
   - ✅ 用户登出
   - ✅ Token黑名单（可选）
   - ✅ 强制登出

##### 5.4 用户信息管理
1. **获取用户信息**
   - ✅ 基于Token获取当前用户
   - ✅ 返回脱敏信息（不含密码）
   - ✅ 包含用户状态

2. **更新用户信息**
   - ✅ 邮箱更新
   - ✅ 密码修改
   - ✅ 用户状态更新

3. **用户状态管理**
   - ✅ 激活/禁用用户（is_active）
   - ✅ 邮箱验证状态（is_verified）
   - ✅ 用户删除（软删除）

##### 5.5 安全特性
1. **密码安全**
   - ✅ bcrypt加密算法
   - ✅ 随机salt生成
   - ✅ 防彩虹表攻击
   - ✅ 密码强度检查（可选）

2. **认证安全**
   - ✅ JWT安全签名
   - ✅ Token过期机制
   - ✅ HTTPS支持（配置）
   - ✅ CORS配置

3. **数据安全**
   - ✅ SQL参数化查询
   - ✅ 防SQL注入
   - ✅ 敏感信息过滤
   - ✅ 错误信息脱敏

##### 5.6 数据库操作
1. **用户CRUD**
   - ✅ 创建用户
   - ✅ 查询用户（by user_id / username / email）
   - ✅ 更新用户
   - ✅ 删除用户

2. **数据迁移**
   - ✅ 15个现有用户成功迁移
   - ✅ 默认密码加密
   - ✅ 数据一致性验证

#### API接口功能（7个）
1. `POST /auth/register` ✅
   - 用户注册
   - 参数：username, email, password
   - 返回：user_id, access_token, refresh_token

2. `POST /auth/login` ✅
   - 用户登录
   - 参数：username/email, password
   - 返回：user_id, access_token, refresh_token

3. `POST /auth/refresh` ✅
   - 刷新Token
   - 参数：refresh_token
   - 返回：新access_token

4. `GET /auth/me` ✅
   - 获取当前用户信息
   - 需要Authorization header
   - 返回：用户信息（脱敏）

5. `POST /auth/logout` ✅
   - 用户登出
   - Token失效

6. `GET /health` ✅
   - 健康检查
   - 数据库连接状态

7. `GET /` ✅
   - 服务信息

---

## 数据库功能清单

### 数据库架构
- **interview_analysis**: 简历分析数据库
- **interview_service**: 面试记录数据库

### 1. interview_analysis 数据库 (5张表)

#### 1.1 users表 - 用户认证主表 ✅
**字段功能** (9个字段):
1. ✅ `id` - 自增主键
2. ✅ `user_id` - 用户UUID唯一标识
3. ✅ `username` - 用户名（唯一）
4. ✅ `email` - 邮箱地址（唯一）
5. ✅ `password_hash` - bcrypt加密密码
6. ✅ `is_active` - 激活状态
7. ✅ `is_verified` - 邮箱验证状态
8. ✅ `created_at` - 创建时间
9. ✅ `updated_at` - 更新时间
10. ✅ `last_login_at` - 最后登录时间

**索引功能** (6个):
- ✅ PRIMARY KEY (id)
- ✅ UNIQUE INDEX (user_id)
- ✅ UNIQUE INDEX (username)
- ✅ UNIQUE INDEX (email)
- ✅ INDEX (is_active)
- ✅ INDEX (created_at)

**数据功能**:
- ✅ 用户认证
- ✅ 用户管理
- ✅ 登录日志
- ✅ 数据迁移（15个用户）

#### 1.2 candidate_profiles表 - 候选人档案主表 ✅
**基础字段功能** (13个):
1. ✅ `id` - 自增主键
2. ✅ `user_id` - 用户唯一标识（UNIQUE）
3. ✅ `name` - 姓名
4. ✅ `phone` - 电话
5. ✅ `email` - 邮箱
6. ✅ `location` - 居住地址
7. ✅ `education` - 教育背景描述
8. ✅ `direction` - 技术发展方向
9. ✅ `total_experience_years` - 总工作年限
10. ✅ `skill_level` - 技能水平等级
11. ✅ `technical_skills_json` - 技术技能JSON
12. ✅ `created_at` - 创建时间
13. ✅ `updated_at` - 更新时间

**扩展字段功能** (8个):
1. ✅ `gender` - 性别
2. ✅ `age` - 年龄
3. ✅ `ethnicity` - 民族
4. ✅ `political_status` - 政治面貌
5. ✅ `university` - 院校
6. ✅ `major` - 专业
7. ✅ `work_experience_detail_json` - 工作经验详细JSON
8. ✅ `project_experience_detail_json` - 项目经验详细JSON

**数据功能**:
- ✅ 简历信息存储
- ✅ 候选人档案管理
- ✅ 与users表1:1关联
- ✅ 支持LLM智能提取

#### 1.3 work_experiences表 - 工作经验表 ✅
**字段功能** (9个):
1. ✅ `id` - 自增主键
2. ✅ `profile_id` - 关联candidate_profiles
3. ✅ `company_name` - 公司名称
4. ✅ `position` - 职位
5. ✅ `start_date` - 开始日期
6. ✅ `end_date` - 结束日期
7. ✅ `description` - 工作描述
8. ✅ `created_at` - 创建时间
9. ✅ `updated_at` - 更新时间

**数据功能**:
- ✅ 多段工作经历存储
- ✅ 与档案主表1:N关联
- ✅ 时间线管理

#### 1.4 projects表 - 项目经验表 ✅
**字段功能** (9个):
1. ✅ `id` - 自增主键
2. ✅ `profile_id` - 关联candidate_profiles
3. ✅ `project_name` - 项目名称
4. ✅ `role` - 项目角色
5. ✅ `start_date` - 开始日期
6. ✅ `end_date` - 结束日期
7. ✅ `description` - 项目描述
8. ✅ `created_at` - 创建时间
9. ✅ `updated_at` - 更新时间

**数据功能**:
- ✅ 多个项目经历存储
- ✅ 与档案主表1:N关联
- ✅ 项目关键词提取

#### 1.5 technical_skills表 - 技术技能表 ✅
**字段功能** (7个):
1. ✅ `id` - 自增主键
2. ✅ `profile_id` - 关联candidate_profiles
3. ✅ `skill_name` - 技能名称
4. ✅ `proficiency_level` - 熟练程度
5. ✅ `years_of_experience` - 使用年限
6. ✅ `created_at` - 创建时间
7. ✅ `updated_at` - 更新时间

**数据功能**:
- ✅ 多项技能记录
- ✅ 与档案主表1:N关联
- ✅ 技能级别管理

### 2. interview_service 数据库 (3张表)

#### 2.1 interview_sessions表 - 面试会话主表 ✅
**字段功能** (13个):
1. ✅ `id` - 自增主键
2. ✅ `session_id` - 会话UUID（UNIQUE）
3. ✅ `user_id` - 用户ID（索引）
4. ✅ `session_name` - 会话名称
5. ✅ `session_type` - 面试类型（technical/behavioral/综合）
6. ✅ `status` - 会话状态（pending/in_progress/completed/canceled）
7. ✅ `difficulty_level` - 难度级别（easy/medium/hard）
8. ✅ `estimated_duration` - 预计时长（分钟）
9. ✅ `actual_duration` - 实际时长（分钟）
10. ✅ `total_questions` - 总题目数量
11. ✅ `completed_questions` - 已完成题目数
12. ✅ `start_time` - 开始时间
13. ✅ `end_time` - 结束时间
14. ✅ `created_at` - 创建时间
15. ✅ `updated_at` - 更新时间

**索引功能** (4个):
- ✅ PRIMARY KEY (id)
- ✅ UNIQUE INDEX (session_id)
- ✅ INDEX (user_id)
- ✅ INDEX (status)

**数据功能**:
- ✅ 面试会话管理
- ✅ 状态流转控制
- ✅ 时长统计
- ✅ 题目数量管理

#### 2.2 interview_questions表 - 面试题目表 ✅
**字段功能** (10个):
1. ✅ `id` - 自增主键
2. ✅ `question_id` - 题目UUID（UNIQUE）
3. ✅ `session_id` - 关联会话（索引）
4. ✅ `question_text` - 题目文本
5. ✅ `question_type` - 题目类型（technical/behavioral/case/coding）
6. ✅ `question_category` - 题目分类
7. ✅ `difficulty_level` - 难度级别
8. ✅ `question_order` - 题目顺序
9. ✅ `knowledge_points` - 知识点标记
10. ✅ `created_at` - 创建时间
11. ✅ `updated_at` - 更新时间

**索引功能**:
- ✅ PRIMARY KEY (id)
- ✅ UNIQUE INDEX (question_id)
- ✅ INDEX (session_id)
- ✅ INDEX (question_type)

**数据功能**:
- ✅ 题目存储
- ✅ 题目分类
- ✅ 顺序管理
- ✅ 知识点标记

#### 2.3 interview_answers表 - 面试回答表 ✅
**字段功能** (9个):
1. ✅ `id` - 自增主键
2. ✅ `question_id` - 关联题目（UNIQUE）
3. ✅ `candidate_answer` - 候选人回答
4. ✅ `interviewer_feedback` - 面试官反馈
5. ✅ `overall_score` - 综合评分（0-100）
6. ✅ `is_wrong_question` - 是否为错题（< 60分）
7. ✅ `answered_at` - 回答时间
8. ✅ `created_at` - 创建时间
9. ✅ `updated_at` - 更新时间

**索引功能**:
- ✅ PRIMARY KEY (id)
- ✅ UNIQUE INDEX (question_id)
- ✅ INDEX (is_wrong_question, session_id) - 错题查询优化

**数据功能**:
- ✅ 回答记录
- ✅ 评分管理
- ✅ 错题自动标记
- ✅ 反馈存储

### 3. Milvus向量数据库 ✅
**功能**:
- ✅ 向量化存储
- ✅ 语义搜索
- ✅ 相似度匹配
- ✅ 集合管理

---

## API接口功能清单

### 接口总览
- **总接口数**: 39个
- **已完成**: 39个 (100%)

### 按功能分类

#### 1. 用户认证相关（7个接口）✅
1. `POST /auth/register` ✅ - 用户注册
2. `POST /auth/login` ✅ - 用户登录
3. `POST /auth/refresh` ✅ - 刷新Token
4. `GET /auth/me` ✅ - 获取当前用户
5. `POST /auth/logout` ✅ - 用户登出
6. `GET /health` (user-auth-service) ✅ - 健康检查
7. `GET /` (user-auth-service) ✅ - 服务信息

#### 2. 简历分析相关（8个接口）✅
1. `POST /analyze` ✅ - 智能简历分析
2. `POST /keywords` ✅ - 获取关键词
3. `GET /keywords/grouped/{user_id}` ✅ - Dify关键词接口
4. `POST /parse-pdf` ✅ - 解析PDF简历
5. `POST /profile` ✅ - 查询用户档案
6. `GET /analyze/status/{user_id}` ✅ - 查询分析状态
7. `GET /health` (analysis-service) ✅ - 健康检查
8. `GET /` (analysis-service) ✅ - 服务信息

#### 3. PDF解析相关（3个接口）✅
1. `POST /parse-pdf` ✅ - PDF文件解析
2. `GET /health` (pdf-parser-service) ✅ - 健康检查
3. `GET /` (pdf-parser-service) ✅ - 服务信息

#### 4. 向量存储相关（约5个接口）✅
1. `POST /vectorize` ✅ - 文本向量化
2. `POST /store` ✅ - 向量存储
3. `POST /search` ✅ - 语义搜索
4. `GET /health` (vector-storage-service) ✅ - 健康检查
5. `GET /` (vector-storage-service) ✅ - 服务信息

#### 5. 面试管理相关（14个接口）✅

##### 5.1 Dify专用接口（6个）✅
1. `POST /dify/interview/create` ✅
   - 创建面试会话
   - 支持题目数量和时长参数

2. `POST /dify/interview/add-qa` ✅
   - 添加问答记录
   - 自动错题标记

3. `GET /dify/interview/{user_id}/latest` ✅
   - 获取最新面试

4. `GET /dify/interview/{session_id}/summary` ✅
   - 获取面试摘要

5. `GET /dify/interview/{user_id}/wrong-questions` ✅
   - 获取错题集

6. `GET /dify/interview/{user_id}/wrong-question-keywords` ✅
   - 获取错题关键词

##### 5.2 标准RESTful接口（8个）✅
1. `POST /interview/sessions` ✅
   - 创建面试会话

2. `GET /interview/sessions/{user_id}` ✅
   - 获取用户所有会话

3. `GET /interview/sessions/{session_id}/detail` ✅
   - 获取会话详情（简化版）

4. `POST /interview/sessions/{session_id}/start` ✅
   - 开始面试

5. `POST /interview/sessions/{session_id}/finish` ✅
   - 结束面试

6. `GET /interview/wrong-questions/{user_id}` ✅
   - 获取错题集（标准版）

7. `GET /health` (interview-service) ✅
   - 健康检查

8. `GET /` (interview-service) ✅
   - 服务信息

#### 6. 健康检查接口（5个）✅
- `GET /health` (user-auth-service) ✅
- `GET /health` (pdf-parser-service) ✅
- `GET /health` (analysis-service) ✅
- `GET /health` (vector-storage-service) ✅
- `GET /health` (interview-service) ✅

---

## 前端功能清单

### 当前状态：未开发（5%）
- ⚠️ 仅有布局HTML文件
- ❌ React项目未初始化

### 规划功能（来自MVP设计）

#### 1. 用户认证模块 ❌
**1.1 登录注册界面**
- ❌ 用户登录表单
  - 用户名/邮箱输入
  - 密码输入
  - 记住我选项
  - 忘记密码链接
  - 登录按钮
  - 注册跳转链接
  
- ❌ 用户注册表单
  - 用户名输入（唯一性验证）
  - 邮箱输入（格式验证）
  - 密码输入（强度提示）
  - 确认密码
  - 用户协议勾选
  - 注册按钮
  - 登录跳转链接

- ❌ 第三方登录（可选）
  - 微信登录
  - QQ登录
  - GitHub登录

**1.2 Token管理**
- ❌ Access Token存储（localStorage/sessionStorage）
- ❌ Refresh Token管理
- ❌ Token自动刷新
- ❌ Token过期处理
- ❌ 自动登出机制

**1.3 个人中心**
- ❌ 用户信息展示
  - 用户名
  - 邮箱
  - 注册时间
  - 最后登录时间
  
- ❌ 个人信息编辑
  - 修改邮箱
  - 修改密码
  - 头像上传（可选）
  
- ❌ 账号安全
  - 密码修改
  - 邮箱验证
  - 登录日志查看

#### 2. 面试核心模块 ❌

**2.1 面试模式选择页**
- ❌ 简历定制模式
  - 上传简历入口
  - 简历状态显示
  - 开始面试按钮
  
- ❌ 公司题库模式
  - 公司列表展示
  - 公司筛选
  - 题目预览
  
- ❌ 知识点模式
  - 知识点分类
  - 知识点选择
  - 难度选择

- ❌ 错题复习模式
  - 错题数量展示
  - 错题分类
  - 开始复习按钮

**2.2 简历上传页**
- ❌ 文件上传组件
  - 拖拽上传
  - 点击上传
  - 文件类型限制（PDF）
  - 文件大小限制（10MB）
  - 上传进度条
  
- ❌ 简历解析状态
  - 解析中动画
  - 解析成功提示
  - 解析失败处理
  - 重新上传选项
  
- ❌ 简历预览
  - PDF预览
  - 提取信息展示
  - 关键词展示

**2.3 面试设置页**
- ❌ 面试参数设置
  - 面试类型选择（技术/行为/综合）
  - 难度级别选择（简单/中等/困难）
  - 题目数量设置（滑块/输入框）
  - 预计时长设置
  
- ❌ 面试规则说明
  - 面试流程介绍
  - 评分标准说明
  - 注意事项提示

**2.4 实时面试对话页**
- ❌ 对话界面
  - 面试官问题展示
  - 候选人回答输入框
  - 富文本编辑器（支持代码格式）
  - 发送按钮
  - 历史对话记录
  
- ❌ 进度显示
  - 当前题目/总题目
  - 进度条
  - 已用时间
  - 预计剩余时间
  
- ❌ 辅助功能
  - 跳过题目
  - 暂停面试
  - 结束面试
  - 保存草稿
  
- ❌ 实时反馈
  - 回答提交成功提示
  - 评分展示（可选）
  - AI反馈展示

**2.5 面试结果页**
- ❌ 面试总结
  - 总分展示
  - 各维度评分
  - 完成时间
  - 完成题目数
  
- ❌ 详细反馈
  - 每题回答展示
  - 每题评分
  - AI反馈
  - 知识点标记
  
- ❌ 错题标记
  - 自动标记错题
  - 错题数量统计
  - 加入错题集提示
  
- ❌ 操作按钮
  - 查看详情
  - 再来一次
  - 返回首页
  - 导出报告

#### 3. 学习管理模块 ❌

**3.1 面试历史记录页**
- ❌ 记录列表
  - 面试时间
  - 面试类型
  - 题目数量
  - 总分
  - 状态标签
  
- ❌ 筛选和排序
  - 按时间筛选
  - 按类型筛选
  - 按分数排序
  - 按状态筛选
  
- ❌ 批量操作
  - 批量删除
  - 批量导出
  - 批量分享

**3.2 错题集页**
- ❌ 错题列表
  - 题目内容
  - 题目类型
  - 难度
  - 错误次数
  - 最后练习时间
  - 知识点标签
  
- ❌ 错题筛选
  - 按类型筛选
  - 按难度筛选
  - 按知识点筛选
  - 按错误次数排序
  
- ❌ 错题复习
  - 开始复习按钮
  - 复习进度
  - 错题收藏
  - 错题标注
  
- ❌ 错题统计
  - 错题总数
  - 按类型统计
  - 按知识点统计
  - 错题率趋势图

**3.3 学习进度页**
- ❌ 总体统计
  - 总面试次数
  - 总题目数
  - 平均分
  - 学习时长
  
- ❌ 数据可视化
  - 分数趋势图
  - 题型分布图
  - 知识点雷达图
  - 学习时长统计
  
- ❌ 学习建议
  - AI学习建议
  - 薄弱知识点提示
  - 推荐练习内容

**3.4 面试报告导出**
- ❌ 报告内容
  - 面试基本信息
  - 题目和回答
  - 评分和反馈
  - 知识点分析
  
- ❌ 导出格式
  - PDF格式
  - Word格式
  - Markdown格式
  
- ❌ 导出选项
  - 单次面试导出
  - 批量导出
  - 自定义内容选择

#### 4. 系统设置模块 ❌

**4.1 界面设置**
- ❌ 主题切换
  - 亮色主题
  - 暗色主题
  - 自动切换
  
- ❌ 语言设置
  - 简体中文
  - 繁体中文
  - 英文（可选）
  
- ❌ 字体大小
  - 小号
  - 中号
  - 大号

**4.2 面试偏好设置**
- ❌ 默认面试参数
  - 默认题目数量
  - 默认难度
  - 默认面试类型
  
- ❌ 提醒设置
  - 面试提醒
  - 错题复习提醒
  - 学习目标提醒

**4.3 帮助与反馈**
- ❌ 使用教程
  - 新手引导
  - 视频教程
  - 常见问题
  
- ❌ 反馈建议
  - 问题反馈表单
  - 功能建议
  - 联系客服
  
- ❌ 关于我们
  - 项目介绍
  - 版本信息
  - 隐私政策
  - 用户协议

#### 5. 通用组件 ❌
- ❌ 导航栏
  - Logo
  - 导航菜单
  - 用户头像
  - 通知中心
  - 快捷操作
  
- ❌ 侧边栏
  - 功能菜单
  - 折叠/展开
  - 活跃状态高亮
  
- ❌ 页面布局
  - 响应式布局
  - 移动端适配
  - 加载动画
  - 空状态页面
  - 错误页面（404, 500）

#### 6. 技术特性 ❌
- ❌ 状态管理（Zustand）
  - 用户状态
  - 面试状态
  - UI状态
  
- ❌ 路由管理（React Router）
  - 路由配置
  - 路由守卫
  - 懒加载
  
- ❌ HTTP客户端（Axios）
  - 请求拦截器
  - 响应拦截器
  - 错误处理
  - 重试机制
  
- ❌ 缓存策略
  - 接口缓存
  - 本地存储
  - IndexedDB
  
- ❌ 性能优化
  - 代码分割
  - 懒加载
  - 虚拟列表
  - 图片懒加载

---

## 集成与工作流功能

### 1. Dify工作流集成 ✅

#### 1.1 工作流配置 ✅
- ✅ Chatflow工作流配置文件（`面试智能体（chatflow版）.yml`）
- ✅ 节点配置
- ✅ 变量配置
- ✅ 条件分支

#### 1.2 后端API对接 ✅
**用户认证流程**:
- ✅ Dify调用用户认证接口
- ✅ Token验证
- ✅ 用户信息获取

**简历分析流程**:
- ✅ Dify调用简历分析接口
- ✅ 获取候选人档案
- ✅ 获取关键词（技术技能、项目、方向）
- ✅ 生成面试题目依据

**面试会话流程**:
- ✅ Dify调用创建面试接口
  - 传递题目数量（用户指定）
  - 传递预计时长
- ✅ 循环生成题目
- ✅ 记录问答（dify/interview/add-qa）
- ✅ 自动错题标记
- ✅ 获取面试摘要

**错题复习流程**:
- ✅ Dify调用错题关键词接口
- ✅ 获取m组关键词
- ✅ 循环生成错题相关题目
- ✅ 记录复习结果

#### 1.3 数据格式适配 ✅
- ✅ Dify友好的JSON格式
- ✅ 简化的返回结构
- ✅ 清晰的字段命名
- ✅ 使用指南注释

### 2. 微服务间集成 ✅

#### 2.1 服务调用链路 ✅
**简历分析链路**:
```
PDF上传 → pdf-parser-service → analysis-service → MySQL
                                      ↓
                                  vector-storage-service → Milvus
```

**面试流程链路**:
```
Dify → interview-service → analysis-service (获取档案)
            ↓
        MySQL (保存记录)
```

**错题查询链路**:
```
Dify → interview-service → MySQL (查询错题) → 返回关键词
```

#### 2.2 服务间通信 ✅
- ✅ HTTP REST API调用
- ✅ 异步请求支持
- ✅ 超时控制
- ✅ 重试机制
- ✅ 错误处理

#### 2.3 数据一致性 ✅
- ✅ 用户ID统一（user_id）
- ✅ 会话ID统一（session_id）
- ✅ 题目ID统一（question_id）
- ✅ 数据关联完整

### 3. 外部服务集成 ✅

#### 3.1 LLM服务集成 ✅
- ✅ 智谱AI GLM-4 API
- ✅ 简历信息提取
- ✅ 关键词提取
- ✅ 错误处理
- ✅ 超时控制

#### 3.2 向量化模型集成 ✅
- ✅ 智谱AI Embedding-2
- ✅ sentence-transformers
- ✅ 文本向量化
- ✅ 语义检索

#### 3.3 数据库集成 ✅
- ✅ MySQL连接池
- ✅ Milvus连接
- ✅ 连接状态监控
- ✅ 自动重连

---

## 安全与认证功能

### 1. 用户认证安全 ✅

#### 1.1 密码安全 ✅
- ✅ bcrypt加密算法
- ✅ 随机salt生成
- ✅ 防彩虹表攻击
- ✅ 密码不可逆加密
- ✅ 密码强度检查（可选）

#### 1.2 Token安全 ✅
- ✅ JWT标准实现
- ✅ Token签名验证
- ✅ Token过期机制（Access 30分钟，Refresh 7天）
- ✅ Token payload加密
- ✅ 防Token篡改

#### 1.3 会话安全 ✅
- ✅ 登录状态验证
- ✅ Token自动刷新
- ✅ 登出Token失效
- ✅ 并发登录控制（可选）

### 2. 数据安全 ✅

#### 2.1 SQL注入防护 ✅
- ✅ 参数化查询
- ✅ ORM使用（SQLAlchemy）
- ✅ 输入验证
- ✅ 特殊字符转义

#### 2.2 XSS防护 ⚠️
- ⚠️ 前端输入过滤（待前端实现）
- ⚠️ 输出编码（待前端实现）
- ✅ 后端数据清洗

#### 2.3 CSRF防护 ⚠️
- ⚠️ CSRF Token（待实现）
- ✅ CORS配置
- ✅ Referer验证

### 3. API安全 ⚠️

#### 3.1 访问控制 ✅
- ✅ JWT认证中间件
- ✅ 路由权限验证
- ✅ 用户状态检查

#### 3.2 速率限制 ⚠️
- ⚠️ API速率限制（待实现）
- ⚠️ IP黑名单（待实现）
- ✅ 并发请求限制（部分）

#### 3.3 HTTPS ⚠️
- ⚠️ HTTPS配置（生产环境待配置）
- ⚠️ 证书管理
- ⚠️ 强制HTTPS重定向

### 4. 数据隐私 ✅

#### 4.1 敏感信息保护 ✅
- ✅ 密码加密存储
- ✅ 返回数据脱敏（不返回密码）
- ✅ 日志敏感信息过滤
- ✅ 错误信息脱敏

#### 4.2 数据访问控制 ✅
- ✅ 用户只能访问自己的数据
- ✅ 会话权限验证
- ✅ 档案权限验证

---

## 运维与监控功能

### 1. 服务部署 ✅

#### 1.1 服务启动 ✅
- ✅ nohup后台运行
- ✅ 日志输出到文件
- ✅ 环境变量配置
- ✅ 端口绑定
- ✅ 启动脚本（start.sh）

#### 1.2 服务停止 ✅
- ✅ 优雅停止
- ✅ 进程查找和终止
- ✅ 停止脚本（stop.sh）

#### 1.3 服务重启 ✅
- ✅ 手动重启流程
- ⚠️ 自动重启（待systemd配置）

### 2. 健康检查 ✅

#### 2.1 服务健康检查 ✅
- ✅ 所有服务/health端点
- ✅ 返回服务状态
- ✅ 返回数据库连接状态
- ✅ 返回依赖服务状态
- ✅ 返回统计信息

#### 2.2 自动化检查 ✅
- ✅ check_services.py脚本
- ✅ 批量健康检查
- ✅ 状态汇总报告

### 3. 日志管理 ✅

#### 3.1 日志记录 ✅
- ✅ Python logging模块
- ✅ 日志级别（DEBUG/INFO/WARNING/ERROR/CRITICAL）
- ✅ 格式化日志输出
- ✅ 时间戳记录
- ✅ 服务名标识

#### 3.2 日志存储 ✅
- ✅ 文件日志（/tmp/*.log）
- ✅ 按服务分文件
- ⚠️ 日志轮转（待配置）
- ⚠️ 日志压缩（待配置）

#### 3.3 日志分析 ⚠️
- ⚠️ 错误日志统计（待实现）
- ⚠️ 性能日志分析（待实现）
- ⚠️ 访问日志分析（待实现）

### 4. 性能监控 ⚠️

#### 4.1 服务监控 ⚠️
- ⚠️ CPU使用率监控（待实现）
- ⚠️ 内存使用率监控（待实现）
- ⚠️ 磁盘IO监控（待实现）
- ⚠️ 网络IO监控（待实现）

#### 4.2 数据库监控 ⚠️
- ⚠️ 连接池状态（待实现）
- ⚠️ 慢查询监控（待实现）
- ⚠️ 数据库大小监控（待实现）

#### 4.3 API性能监控 ⚠️
- ⚠️ 响应时间监控（待实现）
- ⚠️ 吞吐量监控（待实现）
- ⚠️ 错误率监控（待实现）

### 5. 告警机制 ⚠️
- ⚠️ 服务异常告警（待实现）
- ⚠️ 性能告警（待实现）
- ⚠️ 磁盘空间告警（待实现）
- ⚠️ 数据库告警（待实现）

### 6. 备份与恢复 ⚠️

#### 6.1 数据库备份 ⚠️
- ⚠️ MySQL定期备份（待实现）
- ⚠️ Milvus数据备份（待实现）
- ⚠️ 备份策略配置（待实现）

#### 6.2 数据恢复 ⚠️
- ⚠️ 数据恢复流程（待文档化）
- ⚠️ 恢复测试（待实施）

---

## 未实现功能清单

### 高优先级（P0）

#### 1. 前端开发 ❌
- ❌ React项目初始化
- ❌ 用户认证界面
- ❌ 面试流程界面
- ❌ 历史记录界面
- ❌ 错题集界面
- ❌ 响应式布局

**预计工期**: 4-6周

#### 2. API功能增强 ⚠️
- ⚠️ 面试数据统计API
  - 按时间段统计
  - 按类型统计
  - 多维度数据
  
- ⚠️ 面试记录导出API
  - PDF导出
  - Excel导出
  - 自定义格式
  
- ⚠️ 用户学习进度API
  - 进度计算
  - 趋势分析
  - 学习建议

**预计工期**: 1-2周

#### 3. 系统运维工具 ⚠️
- ⚠️ systemd服务配置
  - 服务自动启动
  - 服务自动重启
  - 依赖管理
  
- ⚠️ 日志轮转配置
  - 按大小轮转
  - 按时间轮转
  - 日志压缩
  
- ⚠️ 数据库备份脚本
  - 定期备份
  - 增量备份
  - 备份验证

**预计工期**: 1周

### 中优先级（P1）

#### 1. 功能增强 ❌
- ❌ 学习进度跟踪
  - 学习曲线
  - 知识点掌握度
  - 学习时长统计
  
- ❌ 面试数据可视化
  - 图表展示
  - 趋势分析
  - 对比分析
  
- ❌ 用户反馈系统
  - 反馈表单
  - 问题追踪
  - 功能建议
  
- ❌ 移动端适配
  - 响应式设计
  - 触摸优化
  - 移动端特定功能

**预计工期**: 4-6周

#### 2. 安全加固 ⚠️
- ⚠️ HTTPS配置
  - SSL证书
  - 强制HTTPS
  - 证书自动更新
  
- ⚠️ API速率限制
  - 限流策略
  - IP黑名单
  - 防爬虫
  
- ⚠️ 安全审计
  - 定期检查
  - 漏洞扫描
  - 安全报告

**预计工期**: 2-3周

#### 3. 测试完善 ⚠️
- ⚠️ 单元测试
  - 服务逻辑测试
  - 数据库操作测试
  - API测试
  
- ⚠️ 集成测试自动化
  - 测试脚本
  - CI/CD集成
  - 覆盖率检查
  
- ⚠️ 性能压力测试
  - 并发测试
  - 负载测试
  - 性能基线

**预计工期**: 2-3周

### 低优先级（P2）

#### 1. 管理后台 ❌
- ❌ 管理员登录
- ❌ 用户管理界面
  - 用户列表
  - 用户详情
  - 用户禁用/启用
  
- ❌ 系统监控面板
  - 服务状态
  - 性能指标
  - 告警信息
  
- ❌ 数据统计分析
  - 用户统计
  - 面试统计
  - 系统统计
  
- ❌ 内容管理
  - 题库管理
  - 公司管理
  - 知识点管理

**预计工期**: 4-6周

#### 2. 高级功能 ❌
- ❌ 语音面试
  - 语音输入
  - 语音识别
  - 语音合成
  
- ❌ 企业定制题库
  - 题库上传
  - 题库管理
  - 题库分享
  
- ❌ 批量用户管理
  - 批量导入
  - 批量操作
  - 组织管理
  
- ❌ API接口开放
  - API文档
  - API密钥管理
  - 使用统计

**预计工期**: 6-8周

#### 3. 性能优化 ⚠️
- ⚠️ 缓存机制
  - Redis缓存
  - 查询缓存
  - 页面缓存
  
- ⚠️ CDN配置
  - 静态资源CDN
  - 图片CDN
  - API加速
  
- ⚠️ 数据库优化
  - 索引优化
  - 查询优化
  - 分库分表

**预计工期**: 2-3周

---

## 总结

### 已完成功能统计
- ✅ **后端微服务**: 5个服务，39个API接口
- ✅ **数据库设计**: 9张核心表，完整的数据结构
- ✅ **核心功能**: 
  - 用户认证（注册、登录、Token管理）
  - 简历分析（PDF解析、LLM提取、21个字段）
  - 面试管理（会话、题目、回答、错题集）
  - 向量存储（语义搜索）
  - Dify工作流集成
- ✅ **部署运维**: 所有服务已部署运行

### 待开发功能统计
- ❌ **前端界面**: 0% (最高优先级)
- ⚠️ **API增强**: 20% (部分待实现)
- ⚠️ **运维工具**: 60% (基础完成，需加强)
- ⚠️ **安全加固**: 70% (基础完成，需生产环境配置)
- ❌ **管理后台**: 0% (低优先级)
- ❌ **高级功能**: 0% (低优先级)

### 项目整体完成度
**75%** （后端完整，前端未启动）

---

**文档状态**: ✅ 详细功能点清单完成  
**下一步行动**: 启动前端开发，完成用户界面  
**最后更新**: 2025-10-31
