<view class="container"><view class="header-nav"><text data-event-opts="{{[['tap',[['goBack',['$event']]]]]}}" class="back-btn" bindtap="__e"><view class="fa fa-arrow-left _i"></view></text><text class="nav-title">{{clubDetail.name||'社团详情'}}</text></view><view class="banner-container"><image class="club-banner" src="{{$root.m0}}" mode="aspectFill" data-event-opts="{{[['load',[['onBannerLoad',['$event']]]]]}}" bindload="__e"></image><view class="banner-mask"></view><view class="club-basic-info"><text class="club-name">{{clubDetail.name}}</text><view class="info-tags"><text class="tag-item">{{clubDetail.categoryName||'未知分类'}}</text><text class="tag-item">{{clubDetail.deptName||'未知学院'}}</text></view></view></view><view class="stats-container"><view class="stat-item"><text class="stat-value">{{clubDetail.memberCount||0}}</text><text class="stat-label">成员</text></view><view class="stat-item"><text class="stat-value">{{clubDetail.activityCount||0}}</text><text class="stat-label">活动</text></view><view class="stat-item"><text class="stat-value">{{clubDetail.totalMembersEver||0}}</text><text class="stat-label">历史成员</text></view></view><view class="detail-container"><view class="section"><text class="section-title">社团简介</text><text class="section-content">{{clubDetail.description||'暂无简介'}}</text></view><view class="section"><text class="section-title">基本信息</text><view class="info-list"><view class="info-item"><text class="item-label">社长</text><text class="item-value">{{clubDetail.nickName||'未知'}}</text></view><view class="info-item"><text class="item-label">创建时间</text><text class="item-value">{{$root.m1}}</text></view><view class="info-item"><text class="item-label">活跃成员</text><text class="item-value">{{(clubDetail.activeMemberCount||0)+"人"}}</text></view></view></view><block wx:if="{{$root.g0}}"><view class="section"><text class="section-title">成员分布</text><view class="distribution-chart"><block wx:for="{{clubDetail.memberDistribution}}" wx:for-item="item" wx:for-index="index" wx:key="index"><view class="distribution-item"><view class="bar-container"><view class="bar" style="{{'height:'+(item.percentage+'%')+';'}}"></view></view><text class="bar-label">{{item.name}}</text><text class="bar-value">{{item.count+"人"}}</text></view></block></view></view></block><block wx:if="{{$root.g1}}"><view class="section"><text class="section-title">最新活动</text><view class="activities-list"><block wx:for="{{$root.l0}}" wx:for-item="activity" wx:for-index="__i0__" wx:key="activityId"><view data-event-opts="{{[['tap',[['navigateToActivity',['$0'],[[['clubDetail.latestActivities','activityId',activity.$orig.activityId,'activityId']]]]]]]}}" class="activity-item" bindtap="__e"><image class="activity-cover" src="{{activity.m2}}" mode="aspectFill"></image><view class="activity-info"><text class="activity-title">{{activity.$orig.title}}</text><text class="activity-date">{{activity.m3}}</text></view></view></block></view></view></block></view><view class="action-bar"><block wx:if="{{isLeader}}"><button data-event-opts="{{[['tap',[['handleManageClub',['$event']]]]]}}" class="action-button manage-button" bindtap="__e"><text class="btn-icon"><view class="fa fa-cog _i"></view></text><text class="btn-text">管理社团</text></button></block><block wx:else><block wx:if="{{isMember}}"><button class="action-button quit-button" disabled="{{requesting}}" data-event-opts="{{[['tap',[['handleQuitClub',['$event']]]]]}}" bindtap="__e"><text class="btn-icon"><view class="fa fa-sign-out _i"></view></text><text class="btn-text">{{requesting?'处理中...':'退出社团'}}</text></button></block><block wx:else><button class="action-button join-button" disabled="{{requesting}}" data-event-opts="{{[['tap',[['handleJoinClub',['$event']]]]]}}" bindtap="__e"><text class="btn-icon"><view class="fa fa-user-plus _i"></view></text><text class="btn-text">{{requesting?'处理中...':'申请加入'}}</text></button></block></block></view><block wx:if="{{loading}}"><view class="loading-mask"><view class="loading-container"><view class="loading-animation"></view><text class="loading-text">加载中...</text></view></view></block><block wx:if="{{errorMessage}}"><view class="error-container"><text class="error-icon"><view class="fa fa-exclamation-triangle _i"></view></text><text class="error-text">{{errorMessage}}</text><button data-event-opts="{{[['tap',[['retryLoad',['$event']]]]]}}" class="retry-button" bindtap="__e">重试</button></view></block></view>