<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.guet.happy.mapper.HAchievementMapper">

    <!-- resultMap for HAchievement -->
    <resultMap id="HAchievementResultMap" type="com.guet.happy.domain.HAchievement">
        <id property="achievementId" column="achievement_id"/>
        <result property="clubId" column="club_id"/>
        <result property="publisherId" column="publisher_id"/>
        <result property="title" column="title"/>
        <result property="type" column="type"/>
        <result property="description" column="description"/>
        <result property="achieveDate" column="achieve_date"/>
        <result property="certificateUrl" column="certificate_url"/>
        <result property="status" column="status"/>
        <result property="createdAt" column="created_at"/>
        <result property="deletedAt" column="deleted_at"/>
        <result property="nickName" column="nick_name"/>
    </resultMap>

    <!-- 查看本社团成果 -->
    <select id="selectAchievementByClubId" resultMap="HAchievementResultMap">
        select * from tb_achievement where club_id = #{clubId}
        and tb_achievement.status = 'published'
    </select>

    <select id="selectAchievementById" resultMap="HAchievementResultMap">
        SELECT
            sys_user.nick_name,
            tb_achievement.achievement_id,
            tb_achievement.title,
            tb_achievement.type,
            tb_achievement.description,
            tb_achievement.achieve_date,
            tb_achievement.certificate_url,
            tb_achievement.`status`,
            tb_achievement.created_at
        FROM
            tb_achievement
                INNER JOIN
            sys_user
            ON
                tb_achievement.publisher_id = sys_user.user_id
        WHERE
            tb_achievement.achievement_id = #{achievementId}
    </select>
</mapper>
